# 要件定義書：星座・星学習クイズアプリ

## 📌 プロジェクト概要

### アプリ名
**Stellarium Quiz**（仮）- プラネタリウム体験型 星座・星学習クイズアプリ

### 目的
美しいビジュアルで星座や恒星を楽しく学べる、プラネタリウムのような体験を提供するクイズアプリ

### ターゲットユーザー
- 天文学に興味がある初心者〜中級者
- 星座や星の名前を覚えたい学習者
- 美しい星空の画像を楽しみたいユーザー
- スマホ・PCどちらでも快適に利用したいユーザー

---

## 🎯 機能要件

### 1. クイズ機能

#### 1.1 星座クイズ
- **形式A**: 星座の形（星の配置）を表示し、名前を選択肢から選ぶ
- **形式B**: 星座の説明文（神話・由来など）から名前を当てる
- **出題範囲**: IAU認定88星座すべて
- **表示方法**: 本物の星空画像 + 星座線イラストを重ねて表示

#### 1.2 星の名前当てクイズ
- **出題内容**: 星の明るさ・色・位置情報から固有名を当てる
- **出題範囲**: Hipparcosカタログから明るい有名な星のみ（IAU固有名を持つ星を優先）
- **難易度**: 高度な問題として設定

#### 1.3 出題方式
- 星座クイズと星の名前当てクイズをランダムに混在して出題
- 同一セッション内で両方のクイズタイプが出現

### 2. カテゴリー・難易度選択機能

#### 2.1 天球半球カテゴリー
- **北半球**: 北半球で見える星座・星を出題
- **南半球**: 南半球で見える星座・星を出題
- **全天**: 両半球の星座・星を混在して出題
- ユーザーが設定画面でカテゴリーを選択可能

#### 2.2 難易度レベル
- **小（初級）**: 有名な星座・1等星中心、選択肢4つ
- **中（中級）**: 準有名星座・2〜3等星含む、選択肢6つ
- **上（上級）**: 全88星座・暗い星含む、選択肢8つ、説明文のみ出題も含む
- ユーザーが設定画面でレベルを選択可能

### 3. スコア・正解率表示機能
- 現在のセッションのスコア表示（正解数/出題数）
- 正解率のパーセント表示
- 視覚的に美しいスコア表示UI

### 4. 詳細説明機能
- **星座詳細**:
  - 星座の神話・由来
  - 見える季節・時期
  - 主要な星のリスト
  - 美しい星座画像（実写 + イラスト）

- **星詳細**:
  - 固有名の由来・文化的背景
  - スペクトル型・等級・距離などの科学的データ
  - 所属する星座
  - 実際の星の画像

- **表示タイミング**:
  - 正解・不正解後に「詳しく見る」ボタンで表示
  - クイズとは独立した「図鑑モード」でも閲覧可能

### 5. 設定機能
- カテゴリー選択（北半球/南半球/全天）
- 難易度選択（小/中/上）
- 出題数設定（10問/20問/30問/無制限）
- 音声ON/OFF

---

## 🎨 非機能要件

### 1. デザイン要件（最重要）

#### 1.1 ビジュアル品質
- **最優先事項**: グラフィック・ビジュアルの美しさ
- プラネタリウムを見ているような没入感
- 本物の星空画像を使用（NASA、ESO等の高品質画像）
- イラストと実写の美しい合成
- **星の表示**: **9等星まで全て表示**（約12万個の星）
  - **肉眼観測モード**: 7等星まで（約14,000個、肉眼で見える範囲）
  - **天の川モード**: 9等星まで（約12万個、天の川が見える暗い空での観測範囲）

#### 1.2 UI/UXデザイン
- 暗い背景色（夜空を連想させる深い青〜黒）
- 星が光る・瞬くアニメーション
- スムーズなトランジション効果
- 読みやすい白〜淡い色のテキスト
- 直感的な操作性

#### 1.3 ビジュアル参考イメージ
**重要**: 以下のような表現を目指す

参考画像: `d:/Downloads/about_pc.jpg` (わし座の例)

**求める表現**:
- ✨ **星の明るさ**: 画像よりも**さらに明るく**表示（特に一等星は目立つように）
- 🌟 **星の数**: 9等星まで**全て表示**（画像よりもっと多く、約12万個）
  - 肉眼観測モード: 約14,000個（7等まで）
  - 天の川モード: 約12万個（9等まで）
- 🦅 **星座イラスト**: 半透明で星と線の上に重ねる（画像と同様）
- 📐 **星座線**: 黄色の線で星を繋ぐ（画像と同様）
- 🎨 **全体の雰囲気**: 深い青の夜空、星がたくさん瞬く美しいプラネタリウム体験

**表示要件**:
- 星座を画面いっぱいに表示（余白を最小限に）
- 星座の周囲の星も広範囲に表示
- 背景の星も含めて、視野内の全ての星を表示

### 2. レスポンシブデザイン
- スマートフォン（縦持ち・横持ち）
- タブレット
- PC（デスクトップ・ノートPC）
- 各デバイスで最適な表示・操作性を実現

### 3. パフォーマンス
- 初回ロード時間: 3秒以内
- クイズ切り替え: 瞬時（0.5秒以内）
- 画像遅延読み込み対応
- スムーズなアニメーション（60fps目標）

### 4. データソース
- **星座データ**: IAU公式88星座
- **星座線データ**: Stellarium constellation line data (constellationship.fab)
- **星座イラスト**: Stellarium western sky culture illustrations (WebP形式)
- **星データ**: Hipparcos星表（9等星まで全て含む、約12万個）
  - 肉眼観測モード: 7等まで（約14,000個）
  - 天の川モード: 9等まで（約12万個）
- **固有名**: IAU固有名リスト
- **画像**: NASA, ESO, Stellarium, パブリックドメイン高品質画像

---

## 🚫 非要件（実装しない機能）

- ❌ 時間制限・タイマー機能
- ❌ 正解・不正解履歴の保存
- ❌ ユーザー登録・ログイン機能
- ❌ リーダーボード・ランキング
- ❌ SNSシェア機能（将来的には検討可）
- ❌ オフライン対応（初期バージョンでは対応しない）

---

## ⚠️ 絶対禁止事項

### データ取得時の手抜き厳禁
**最重要**: 以下の行為は絶対に禁止

- ❌ **星データの部分読み込み禁止**
  - 「時間がかかるから」という理由でデータを3分の1だけ読む
  - 「処理が重いから」という理由でデータを10分の1だけ読む
  - サンプリングや間引きによるデータ削減

- **必須要件**
  - 9等星まで**全て**取得（約12万個）
  - Hipparcos星表から対象範囲を**完全に**読み込む
  - データ取得時は100%完全な状態で処理
  - 表示時も視野内の星は**全て**描画
  - 2つの観測モード実装
    - 肉眼観測モード: 7等まで（約14,000個）
    - 天の川モード: 9等まで（約12万個）

**理由**:
- プラネタリウム体験には十分な星の数が不可欠
- データが少ないと「星が少ない」という致命的な問題になる
- 時間がかかっても品質を優先する

---

## 📊 成功基準

### 定量的基準
- ページロード時間 < 3秒
- レスポンシブ対応: スマホ/タブレット/PC全対応
- 星座88個すべてのデータ整備（星座線・イラスト含む）
- **9等星まで全て表示（約12万個の星）**
  - 肉眼観測モード: 約14,000個（7等まで）
  - 天の川モード: 約12万個（9等まで）
- 明るい星100個以上の問題作成
- 60fpsで星空描画
- 2つの投影モード実装（Orthographic/Stereographic）

### 定性的基準
- ビジュアルが美しく、プラネタリウムのような体験
- 初心者でも直感的に操作できるUI
- 学習効果が高い（詳細説明が充実）
- 「また遊びたい」と思える楽しさ

---

## 🔄 将来的な拡張案（Phase 2以降）

- 実際の星空をAR表示する機能
- 天体観測イベント情報の通知
- ユーザー投稿の星空写真ギャラリー
- 多言語対応（英語・中国語など）
- 音声読み上げ機能（アクセシビリティ）

---

## 📅 制約事項

### 技術的制約
- ブラウザベースのWebアプリケーション
- モダンブラウザのみ対応（Chrome, Firefox, Safari, Edge最新版）
- 画像サイズ制限: 高品質だが適切に圧縮

### データ制約
- 星データ: Hipparcos星表の範囲内
- 星座画像: 著作権フリー・パブリックドメインのみ使用

### 運用制約
- サーバーレス構成を想定（静的ホスティング）
- データベース不要（JSONファイルベース）

---

## ✅ 承認

このドキュメントは以下の要件を満たすアプリケーション開発の基準となります。

- 作成日: 2025-10-16
- バージョン: 2.0
- 更新日: 2025-10-18
